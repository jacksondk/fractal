<html>
<head>
    <title>Fractals with Web Workers</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/complex.js"></script>
    <script type="text/javascript" src="js/fractal.js"></script>
</head>
<body>
    <script type="text/javascript">
        $(document).ready(function () {
            var fra = new jacksondk.Fractal(document.getElementById("fractal"), 2);

            fra.ondone = function (duration) {
                $("#duration").append("Mandel duration : " + duration + " ms<br/>");
            };
            fra.render();

            var julia = new jacksondk.Fractal(document.getElementById("julia"), 2);
            julia.ondone = function (duration) {
                $("#duration").html("Julia Duration : " + duration + " ms");
            };
            julia.setType("julia");
            julia.setTopLeft(new Complex(-2, 2));
            julia.setBottomRight(new Complex(2, -2));
            julia.juliaPoint = new Complex(-0.123, 0.745);


            $("#render").click(function () {
                fra.workerCount = parseInt($("#workerCount").val());
                fra.setType("mandelbrot");
                fra.render();
            });

            $("#fractal").click(function (event) {
                var x = event.offsetX;
                var y = event.offsetY;
                var r = fra.topLeft.real + ((fra.bottomRight.real - fra.topLeft.real) / fra.width) * x;
                var i = fra.topLeft.imag + ((fra.bottomRight.imag - fra.topLeft.imag) / fra.height) * y;

                julia.juliaPoint = new Complex(r, i);
                julia.render();
            });
        });
    </script>
    <h1>
        An experiment with Web-Workers and fractals</h1>
    <p>
        In order to learn about the concept of web workers I revived one of my first programming
        experiments; creating fractals like the Mandelbrot set.
    </p>
    <div>
        <h1>
            Mandelbrot</h1>
        <canvas id="fractal" width="600" height="400">Needs canvas support</canvas>
        <h2>
            Actions</h2>
        <input type="text" id="workerCount" />
        <div id="render" style="border-style: solid">
            Render again</div>
        <div id="duration">
        </div>
    </div>
    <div>
        <h1>
            Julia</h1>
        <canvas id="julia" width="600" height="400" />
    </div>
</body>
</html>
